<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form method='get' onsubmit="startTH()">
    <input type="text"  id="player">
    <input type="submit" name="submit">
</form>
<script>
    function setCookie(cookieName, cookieValue, expireDays) {
        let date = new Date();
        date.setTime(date.getTime() + (expireDays * 24 * 60 * 60 * 1000));
        let expires = "expires=" + date.toUTCString();
        document.cookie = cookieName + "=" + cookieValue + ";" + expires + ";path=/";
    }



    const params = new URLSearchParams(location.search);
    let id = "";
    //get the treasure hunt id from the url to use it for the fetch funnction
    if(params.has("treasure-hunt-id")){
        id = params.get("treasure-hunt-id");
    }

    let string = "&app=treasureHuntGroupA2&treasure-hunt-id=" + id;
    let session = "";
    //prompt the user to enter it;s username so the treasure hunt questions can start
   async function startTH(){
       //prevent the page from refreshing when submit button is pressed
        event.preventDefault();
       let player = document.getElementById("player").value;
       await fetch("https://codecyprus.org/th/api/start?player=" + player + string).then(response => response.json()) //Parse JSON text to JavaScript object
           .then(jsonObject => {
               setCookie("session", jsonObject.session, 10);
               window.location.href = "question.html";
           });

    }
    var cookies1 = document.cookie;

</script>
</body>
</html>