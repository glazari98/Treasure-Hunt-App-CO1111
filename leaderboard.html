<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="app.css"/>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-529VLQPE0H"></script>
    <title>Leaderboard</title>
</head>
<body>

<header>

    <div  class="navigation">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="app.html">List of Treasure Hunts</a></li>
            <li><a href="index.html#aims" >About Us</a></li>
        </ul>
    </div>
</header>
<main>
    <div class="leaderboard">
        <p>Leaderboard</p>
        <ul id="challenges"></ul>
    <table id="test-results-table">
    </table>
    </div>
</main>




<footer>
    Copyright Â© 2024 UCLan Cyprus, All rights reserved.
</footer>
<script>

    const TH_API_URL = "https://codecyprus.org/th/api/";
    // the API base url/*** This is a function to access the /leaderboard at the specified URL*/
    function getLeaderBoard(url) {// create and invoke the http request
        fetch(url, { method: "GET" }).then(response => response.json()).then(json => handleLeaderboard(json));
    }// for now, hardcoded
    let session = "ag9nfmNvZGVjeXBydXNvcmdyFAsSB1Nlc3Npb24YgICA4OnngggM";
    let url = TH_API_URL + "leaderboard?sorted&session=" + session; // form url
    getLeaderBoard(url);

    function handleLeaderboard(leaderboard) {
        let html = ""; // used to include HTML code for the table rows
        let leaderboardArray = leaderboard['leaderboard'];
        for(const entry of leaderboardArray) {
            html += "<tr>" +"<td>" +
                entry['player'] +
                "</td>" +"<td>" +
                entry['score'] +
                "</td>" +"<td>" +
                entry['completionTime'] +
                "</td>" +"</tr>";
        }
        let leaderboardElement = document.getElementById('test-results-table');
        // table
        leaderboardElement.innerHTML += html; // append generated HTML to existing
    }
</script>

</body>
</html>
